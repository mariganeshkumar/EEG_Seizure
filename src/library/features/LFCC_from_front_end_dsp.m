function feature= LFCC_from_front_end_dsp(config, data, samp_rate)
%    feature = compute_LFCC_from_front_end_dsp(...
%                                               data,...
%                                               config.win_size,...
%                                               config.overlap,...
%                                               config.lfreq,...
%                                               config.hfreq,...
%                                               config.samp_rate,...
%                                               config.numceps,...
%                                               config.numfilters,...
%                                               config.nfft,...
%                                               config.fftorder,...
%                                               config.numfilters,...
%                                               config.delta_1,...
%                                               config.delta_2...
%                                               );
[m, ~] = size(data);
for i=1:m
 feature(i,:,:) = ComputeLFCC(...
                                               data(i,:)',...
                                               config.win_size/1000*samp_rate,...
                                               (config.win_size/1000*samp_rate) - (config.overlap/1000*samp_rate),...
                                               config.nfft,...
                                               samp_rate,...
                                               config.numfilters,...
                                               config.numceps,...
                                               config.lfreq,...
                                               config.hfreq,...
                                               config.delta_1,...
                                               config.delta_2...
                                               );
end

end
function feature_mat= compute_LFCC_from_front_end_dsp(data,Ws,overlap,v_fmin,v_fmax,v_fs,v_numceps,v_numfilters,v_fftsize,v_fftorder,v_filterorder,delta,deltadelta)
% Input: Rawdata or Mean subtracted data which is segregrated. No of sample * time
% Output: LFCC Feature cell. 128*No_of_frames*No_of_coeff
% Configure the base file to set feature extraction parameters.

% Writing data into separate text files for feature e
shift=Ws-overlap;
mkdir tmp/rawtxtfiles
mkdir tmp/features
rawdata=data;
num_channels=size(rawdata,1);
parfor i=1:num_channels
    ri=rawdata(i,:)';
    fname1=char(strcat('tmp/rawtxtfiles/',num2str(i)));
    dlmwrite(fname1,ri,'delimiter',' ');
end

%feature_cell=cell(num_channels,1);
cmd=char(strcat({'sh library/features/fe_tomari.sh'},{' '},{num2str(Ws)},{' '},{num2str(shift)},{' '},{num2str(v_numceps)},{' '},{num2str(v_numfilters)},{' '},{num2str(v_fftsize)},{' '},{num2str(v_fftorder)},{' '},{num2str(v_fs)},{' '},{num2str(v_filterorder)},{' '},{num2str(v_fmin)},{' '},{num2str(v_fmax)},{' '},{num2str(delta)},{' '},{num2str(deltadelta)},{' '},{'tmp/rawtxtfiles'}));

disp(cmd);

system(cmd);

parfor i=1:num_channels
    fname2=strcat('tmp/features/',num2str(i));
    mat1=dlmread(fname2,' ',1,1);
    feature_mat(i,: ,:)=mat1';
end
system('rm -rf tmp/features');
system('rm -rf tmp/rawtxtfiles');
disp('end');
end

